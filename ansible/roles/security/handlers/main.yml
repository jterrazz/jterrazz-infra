---
# Security role handlers

- name: Restart sshd
  ansible.builtin.systemd:
    name: ssh
    state: restarted
    daemon_reload: true
  listen: "restart sshd"

- name: Restart fail2ban
  ansible.builtin.systemd:
    name: fail2ban
    state: restarted
    daemon_reload: true
  listen: "restart fail2ban"

- name: Restart auditd
  ansible.builtin.systemd:
    name: auditd
    state: restarted
    daemon_reload: true
  listen: "restart auditd"

- name: Reload ufw
  ufw:
    state: reloaded
  listen: "reload ufw"

- name: Restart avahi-daemon
  ansible.builtin.systemd:
    name: avahi-daemon
    state: restarted
    daemon_reload: true
  listen: "restart avahi-daemon"
